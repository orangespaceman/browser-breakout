<a href="javascript:(function(){var browserBreakout=function(){var body=null,canvas=null,drawContext=null,drawInterval=null,reseting=false,gameState='title',textBlocks={},textAnimationTypes=['default','vertical','horizontal','random','reverse'],images=[],imagesAcceptable=0,imagesRemaining=0,visibleXStart=0,visibleXEnd=0,visibleYStart=0,visibleYEnd=0,visibleWidth=0,visibleHeight=0,ballRadius=7,ballColour='#FFFFFF',ballXStart=ballX=35,ballYStart=ballY=35,ballDxStart=ballDx=2,ballDyStart=ballDy=2,ballVelocity=3,paddleColour='#FFFFFF',paddleX=0,paddleY=0,paddleHeight=10,paddleWidth=100,lastScore=0,topScore=0,canvasTransparency=0,targetTransparency=0.7,downDown=false,upDown=false,leftDown=false,rightDown=false,debugMode=false,debugTimeout=null,hideOverflow=function(){debug('hideOverflow()');body=document.getElementsByTagName('body')[0];body.style.overflow='hidden';},createCanvas=function(){debug('createCanvas()');canvas=document.createElement('canvas');canvas.id='canvas';canvas.style.position='absolute';canvas.style.zIndex=10000000;setCanvasPosition();body.appendChild(canvas);drawContext=canvas.getContext('2d');},setCanvasPosition=function(){canvas.width=visibleWidth;canvas.height=visibleHeight;canvas.style.left=visibleXStart+'px';canvas.style.top=visibleYStart+'px';},calculatePositions=function(){visibleXStart=window.pageXOffset;visibleYStart=window.pageYOffset;visibleWidth=window.innerWidth;visibleHeight=window.innerHeight;visibleXEnd=visibleWidth+visibleXStart;visibleYEnd=visibleHeight+visibleYStart;ballX+=visibleXStart;ballY+=visibleYStart;},collectImages=function(){debug('collectImages()');var allImages=document.getElementsByTagName('img');debug('collectImages: visible frame -  X:'+visibleXStart+'-'+visibleXEnd+'; Y: '+visibleYStart+'-'+visibleYEnd+';');for(var counter=allImages.length-1;counter>=0;counter--){var imagePosition=findPos(allImages[counter]);var imageXStart=imagePosition[0]-visibleXStart;var imageYStart=imagePosition[1]-visibleYStart;var imageWidth=allImages[counter].style.width||allImages[counter].width;var imageHeight=allImages[counter].style.height||allImages[counter].height;if(imageWidth>20&&imageHeight>20){if(imageXStart>(paddleHeight*2)&&imageYStart>(paddleHeight*2)&&(visibleXStart+imageXStart+imageWidth)<visibleXEnd-(paddleHeight*2)&&(visibleYStart+imageYStart+imageHeight)<visibleYEnd-(paddleHeight*2)){images.push({'imageXStart':imageXStart,'imageYStart':imageYStart,'imageWidth':imageWidth,'imageHeight':imageHeight,'image':allImages[counter],'state':1,'visible':0});}}}imagesAcceptable=imagesRemaining=images.length;debug('collectImages: - found '+imagesAcceptable+' out of '+allImages.length);},findPos=function(obj){var curleft=curtop=0;if(obj.offsetParent){while(obj.offsetParent){curleft+=obj.offsetLeft;curtop+=obj.offsetTop;obj=obj.offsetParent;}}return[curleft,curtop];},onKeyDown=function(evt){if(!evt){evt=window.event;}if(evt.keyCode==40){downDown=true;}else if(evt.keyCode==38){upDown=true;}if(evt.keyCode==39){rightDown=true;}else if(evt.keyCode==37){leftDown=true;}},onKeyUp=function(evt){if(!evt){evt=window.event;}if(evt.keyCode==40){downDown=false;}else if(evt.keyCode==38){upDown=false;}if(evt.keyCode==39){rightDown=false;}else if(evt.keyCode==37){leftDown=false;}},onMouseMove=function(evt){if(!evt){evt=window.event;}if(evt.pageX>0&&evt.pageX<visibleXStart+visibleWidth){paddleX=Math.max(evt.pageX-visibleXStart-(paddleWidth/2),0);paddleX=Math.min(canvas.width-paddleWidth,paddleX);}if(evt.pageY>0&&evt.pageY<visibleYStart+visibleHeight){paddleY=Math.max(evt.pageY-visibleYStart-(paddleWidth/2),0);paddleY=Math.min(canvas.height-paddleWidth,paddleY);}},onMouseClick=function(evt){if(!evt){evt=window.event;}if(gameState!='running'){if(imagesAcceptable==0){updateGameState('noImages');}else{updateGameState('running');}}},drawBg=function(){drawContext.clearRect(0,0,canvas.width,canvas.height);drawContext.fillStyle='rgba(0, 0, 0, '+canvasTransparency+')';drawContext.fillRect(0,0,canvas.width,canvas.height);},drawTitle=function(){if(!textBlocks.titleBlock){textBlocks.titleBlock=new CanvasLetters({textString:'Browser',name:'titleBlock',x:25,y:25,blockSize:10,animate:true,ordering:textAnimationTypes[Math.round(Math.random()*textAnimationTypes.length-1)]});}if(!textBlocks.subTitleBlock){textBlocks.subTitleBlock=new CanvasLetters({textString:'Breakout',name:'subTitleBlock',x:25,y:125,blockSize:10,animate:true,ordering:textAnimationTypes[Math.round(Math.random()*textAnimationTypes.length-1)]});}},drawPlayNow=function(){if(!textBlocks.playNow){textBlocks.playNow=new CanvasLetters({textString:'Click to play',name:'playNow',x:25,y:250,blockSize:5});}},drawTopScores=function(){if(!textBlocks.lastScore){textBlocks.lastScore=new CanvasLetters({textString:'Last score - '+lastScore,name:'lastScore',x:25,y:-25,blockSize:2,clearance:2});}if(!textBlocks.topScore){textBlocks.topScore=new CanvasLetters({textString:'Top score - '+topScore,name:'topScore',x:25,y:-50,blockSize:2,clearance:2});}},drawCreds=function(){if(!textBlocks.creds){textBlocks.creds=new CanvasLetters({textString:'petegoodman.com',name:'creds',x:-25,y:-25,blockSize:2,clearance:2});}},drawScore=function(){if(!textBlocks.score){textBlocks.score=new CanvasLetters({textString:'Score - '+(imagesAcceptable-imagesRemaining),name:'score',x:25,y:-25,blockSize:2,clearance:2});}if(!textBlocks.remaining){textBlocks.remaining=new CanvasLetters({textString:'Blocks Remaining - '+imagesRemaining,name:'remaining',x:-25,y:-25,blockSize:2,clearance:2});}},drawLoseMessage=function(){if(!textBlocks.loseMessage){textBlocks.loseMessage=new CanvasLetters({textString:'You Lose',name:'loseMessage',x:-25,y:25,blockSize:5,clearance:5});}},drawWinMessage=function(){if(!textBlocks.winMessage){textBlocks.winMessage=new CanvasLetters({textString:'You Win!',name:'winMessage',x:-25,y:25,blockSize:5,clearance:5});}},drawNoImagesMessage=function(){if(!textBlocks.noImages){textBlocks.noImages=new CanvasLetters({textString:'No suitable images found',name:'noImages',x:25,y:400,blockSize:5,clearance:5});}},drawBlocks=function(){for(textBlock in textBlocks){if(textBlocks[textBlock].isActive()){textBlocks[textBlock].drawBlocks();}};},updateGameState=function(state){drawBg();removeAllText();updateHighScore();gameState=state;ballX=ballXStart;ballY=ballYStart;ballDx=ballDxStart;ballDy=ballDyStart;for(var i=images.length-1;i>=0;i--){images[i].state=1;images[i].visible=0;}if(state!='running'){textBlocks.titleBlock.setActiveVal(1);textBlocks.subTitleBlock.setActiveVal(1);textBlocks.creds.setActiveVal(1);textBlocks.lastScore.updateString('Last score - '+lastScore);textBlocks.topScore.updateString('Top score - '+topScore);if(state=='noImages'){if(!!textBlocks.noImages){textBlocks.noImages.setActiveVal(1);}}else if(state=='gameEnded'){if(!!textBlocks.loseMessage){textBlocks.loseMessage.setActiveVal(1);}}else if(state=='victory'){if(!!textBlocks.winMessage){textBlocks.winMessage.setActiveVal(1);}}}else{if(!!textBlocks.score&&!!textBlocks.remaining){textBlocks.score.updateString('Score - '+(imagesAcceptable-imagesRemaining));textBlocks.remaining.updateString('Blocks Remaining - '+imagesRemaining);}}imagesRemaining=imagesAcceptable;debug('changed gameState to '+state);},removeAllText=function(){for(textBlock in textBlocks){textBlocks[textBlock].setActiveVal(0);}},updateScore=function(){imagesRemaining--;textBlocks.score.updateString('Score - '+(imagesAcceptable-imagesRemaining));textBlocks.remaining.updateString('Blocks Remaining - '+imagesRemaining);},updateHighScore=function(){lastScore=imagesAcceptable-imagesRemaining;if(lastScore>topScore){topScore=lastScore;}},drawImages=function(){for(var counter=images.length-1;counter>=0;counter--){var image=images[counter];if(image.state==1&&ballX>image.imageXStart&&ballX<image.imageXStart+image.imageWidth&&ballY>image.imageYStart&&ballY<image.imageYStart+image.imageHeight){var hit=[{dir:'top',val:ballY-image.imageYStart},{dir:'bottom',val:(image.imageYStart+image.imageHeight)-ballY},{dir:'left',val:ballX-image.imageXStart},{dir:'right',val:(image.imageXStart+image.imageWidth)-ballX}];function sortByLowest(a,b){var x=a.val;var y=b.val;return((x<y)?-1:((x>y)?1:0));}hit.sort(sortByLowest);if(hit[0].dir=='top'||hit[0].dir=='bottom'){ballDy=-ballDy;}else{ballDx=-ballDx;}updateScore();image.state=0;}if(image.state==1){drawContext.drawImage(image.image,image.imageXStart,image.imageYStart);}};},drawBall=function(){var v=ballVelocity;if(Math.abs(ballDx)<1||Math.abs(ballDy)<1){v+=1;}if(Math.abs(ballDx)<1&&Math.abs(ballDy)<1){v+=1;}if(Math.abs(ballDx)<0.75&&Math.abs(ballDy)<0.75){v+=1;}if(Math.abs(ballDx)<0.5&&Math.abs(ballDy)<0.5){v+=1;}ballX+=v*ballDx;ballY+=v*ballDy;drawContext.fillStyle=ballColour;drawCircle(ballX,ballY,ballRadius);},drawPaddles=function(){if(rightDown){paddleX+=20;}else if(leftDown){paddleX-=20;}if(downDown){paddleY+=20;}else if(upDown){paddleY-=20;}if(paddleX<0){paddleX=0;}if(paddleX>visibleWidth-paddleWidth){paddleX=visibleWidth-paddleWidth;}if(paddleY<0){paddleY=0;}if(paddleY>visibleHeight-paddleWidth){paddleY=visibleHeight-paddleWidth;}drawContext.fillStyle='rgba(0, 0, 0, '+canvasTransparency+')';if(ballY+ballDy+ballRadius>visibleHeight-paddleHeight){if(ballX>paddleX&&ballX<paddleX+paddleWidth){ballDx=5*((ballX-(paddleX+paddleWidth/2))/paddleWidth);ballDy=-ballDy;debug('Bottom Paddle Hit - Dx: '+ballDx+'; Dy: '+ballDy);}}if(ballY+ballDy-ballRadius<paddleHeight){if(ballX>paddleX&&ballX<paddleX+paddleWidth){ballDx=5*((ballX-(paddleX+paddleWidth/2))/paddleWidth);ballDy=-ballDy;debug('Top Paddle Hit - Dx: '+ballDx+'; Dy: '+ballDy);}}if(ballX+ballDx+ballRadius>visibleWidth-paddleHeight){if(ballY>paddleY&&ballY<paddleY+paddleWidth){ballDy=5*((ballY-(paddleY+paddleWidth/2))/paddleWidth);ballDx=-ballDx;debug('Right Paddle Hit: '+ballDx+'; Dy: '+ballDy);}}if(ballX+ballDx-ballRadius<paddleHeight){if(ballY>paddleY&&ballY<paddleY+paddleWidth){ballDy=5*((ballY-(paddleY+paddleWidth/2))/paddleWidth);ballDx=-ballDx;debug('Left Paddle Hit: '+ballDx+'; Dy: '+ballDy);}}drawContext.fillStyle=paddleColour;drawRectangle(paddleX,0,paddleWidth,paddleHeight);drawRectangle(paddleX,visibleHeight-paddleHeight,paddleWidth,paddleHeight);drawRectangle(0,paddleY,paddleHeight,paddleWidth);drawRectangle(visibleWidth-paddleHeight,paddleY,paddleHeight,paddleWidth);},drawCircle=function(x,y,r){drawContext.beginPath();drawContext.arc(x,y,r,0,Math.PI*2,true);drawContext.closePath();drawContext.fill();},drawRectangle=function(x,y,w,h){drawContext.beginPath();drawContext.rect(x,y,w,h);drawContext.closePath();drawContext.fill();},draw=function(){switch(gameState){case 'title':case 'gameEnded':case 'victory':case 'noImages':if(canvasTransparency<targetTransparency){canvasTransparency+=0.1;drawBg();}else{drawTitle();drawPlayNow();drawTopScores();drawCreds();drawBlocks();if(gameState=='gameEnded'){drawLoseMessage();}else if(gameState=='victory'){drawWinMessage();}else if(gameState=='noImages'){drawNoImagesMessage();}}break;case 'running':drawBg();drawBall();drawScore();drawImages();drawPaddles();drawBlocks();if(imagesRemaining==0){updateGameState('victory');}if(ballX+ballDx+ballRadius>visibleWidth||ballX+ballDx-ballRadius<0||ballY+ballDy+ballRadius>visibleHeight||ballY+ballDy-ballRadius<0){updateGameState('gameEnded');}break;}},debug=function(content){if(!!debugMode){console.log(content);clearTimeout(debugTimeout);debugTimeout=setTimeout(debugSpacer,2000);}},debugSpacer=function(){if(!!debugMode){console.log('----------------------------------------------------------------------------------');}},init=function(){debug('init()');hideOverflow();calculatePositions();collectImages();if(!canvas){createCanvas();}document.onmousemove=function(e){onMouseMove(e);};document.onkeydown=function(e){onKeyDown(e);};document.onkeyup=function(e){onKeyUp(e);};document.onclick=function(e){onMouseClick(e);};document.onkeypress=function(e){onMouseClick(e);if(!e){e=window.event;}if(e.keyCode==40||e.keyCode==38||e.keyCode==39||e.keyCode==37){return false;}if(e.keyCode==27||e.keyCode==120){canvas.parentNode.removeChild(canvas);}};drawInterval=setInterval(draw,25);},resetGame=function(){if(!reseting){reseting=true;clearInterval(drawInterval);debug('game reset');updateGameState('title');canvasTransparency=0;images=[];imagesAcceptable=0;calculatePositions();setCanvasPosition();init();}reseting=false;};window.onresize=function(){resetGame();};var CanvasLetters=function(initOptions){var blocks=[],blockCount=0,currentX=0,currentY=0,currentBlock=0,lineCount=1,characterBlockWidth=5,characterBlockHeight=7,textString='',characters={'a':[0,0,1,0,0,0,1,0,1,0,1,0,0,0,1,1,0,0,0,1,1,1,1,1,1,1,0,0,0,1,1,0,0,0,1],'b':[1,1,1,1,0,1,0,0,0,1,1,0,0,0,1,1,1,1,1,0,1,0,0,0,1,1,0,0,0,1,1,1,1,1,0],'c':[0,1,1,1,0,1,0,0,0,1,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,1,0,1,1,1,0],'d':[1,1,1,0,0,1,0,0,1,0,1,0,0,0,1,1,0,0,0,1,1,0,0,0,1,1,0,0,1,0,1,1,1,0,0],'e':[1,1,1,1,1,1,0,0,0,0,1,0,0,0,0,1,1,1,0,0,1,0,0,0,0,1,0,0,0,0,1,1,1,1,1],'f':[1,1,1,1,1,1,0,0,0,0,1,0,0,0,0,1,1,1,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0],'g':[0,1,1,1,0,1,0,0,0,1,1,0,0,0,0,1,0,1,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1],'h':[1,0,0,0,1,1,0,0,0,1,1,0,0,0,1,1,1,1,1,1,1,0,0,0,1,1,0,0,0,1,1,0,0,0,1],'i':[1,1,1,1,1,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,1,1,1,1,1],'j':[1,1,1,1,1,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,1,0,1,0,0,1,0,1,0,0,1,1,1,0,0],'k':[1,0,0,0,1,1,0,0,1,0,1,0,1,0,0,1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1],'l':[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,1,1,1,1],'m':[1,0,0,0,1,1,1,0,1,1,1,0,1,0,1,1,0,1,0,1,1,0,0,0,1,1,0,0,0,1,1,0,0,0,1],'n':[1,0,0,0,1,1,0,0,0,1,1,1,0,0,1,1,0,1,0,1,1,0,0,1,1,1,0,0,0,1,1,0,0,0,1],'o':[0,1,1,1,0,1,0,0,0,1,1,0,0,0,1,1,0,0,0,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,0],'p':[1,1,1,1,0,1,0,0,0,1,1,0,0,0,1,1,1,1,1,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0],'q':[0,1,1,1,0,1,0,0,0,1,1,0,0,0,1,1,0,0,0,1,1,0,1,0,1,1,0,0,1,0,0,1,1,0,1],'r':[1,1,1,1,0,1,0,0,0,1,1,0,0,0,1,1,1,1,1,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1],'s':[0,1,1,1,0,1,0,0,0,1,1,0,0,0,0,0,1,1,1,0,0,0,0,0,1,1,0,0,0,1,0,1,1,1,0],'t':[1,1,1,1,1,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0],'u':[1,0,0,0,1,1,0,0,0,1,1,0,0,0,1,1,0,0,0,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,0],'v':[1,0,0,0,1,1,0,0,0,1,1,0,0,0,1,0,1,0,1,0,0,1,0,1,0,0,0,1,0,0,0,0,1,0,0],'w':[1,0,0,0,1,1,0,0,0,1,1,0,0,0,1,1,0,1,0,1,1,0,1,0,1,1,0,1,0,1,0,1,0,1,0],'x':[1,0,0,0,1,1,0,0,0,1,0,1,0,1,0,0,0,1,0,0,0,1,0,1,0,1,0,0,0,1,1,0,0,0,1],'y':[1,0,0,0,1,1,0,0,0,1,1,0,0,0,1,0,1,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0],'z':[1,1,1,1,1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,1,1,1,1,1],'0':[0,1,1,1,0,1,0,0,0,1,1,0,0,1,1,1,0,1,0,1,1,1,0,0,1,1,0,0,0,1,0,1,1,1,0],'1':[0,0,1,0,0,0,1,1,0,0,1,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,1,1,1,1,1],'2':[0,1,1,1,0,1,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,1,1,1,1],'3':[0,1,1,1,0,1,0,0,0,1,0,0,0,0,1,0,0,1,1,0,0,0,0,0,1,1,0,0,0,1,0,1,1,1,0],'4':[0,0,0,1,0,0,0,1,1,0,0,1,0,1,0,1,0,0,1,0,1,1,1,1,1,0,0,0,1,0,0,0,0,1,0],'5':[1,1,1,1,1,1,0,0,0,0,1,0,0,0,0,1,1,1,1,0,0,0,0,0,1,1,0,0,0,1,0,1,1,1,0],'6':[0,0,1,1,0,0,1,0,0,0,1,0,0,0,0,1,1,1,1,0,1,0,0,0,1,1,0,0,0,1,0,1,1,1,0],'7':[1,1,1,1,1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0],'8':[0,1,1,1,0,1,0,0,0,1,1,0,0,0,1,0,1,1,1,0,1,0,0,0,1,1,0,0,0,1,0,1,1,1,0],'9':[0,1,1,1,0,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,0,0,1,0,0,0,1,0,0,1,1,0,0],'-':[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],'?':[0,1,1,1,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0],'!':[0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0],'@':[0,1,1,1,0,1,0,0,0,1,1,0,1,1,1,1,0,1,0,1,1,0,1,1,0,1,0,0,0,1,0,1,1,1,0],'&':[0,1,1,0,0,1,0,0,1,0,1,0,1,0,0,0,1,0,0,0,1,0,1,0,1,1,0,0,1,0,0,1,1,0,1],'.':[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0],' ':[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},defaults={blockColour:'ff9900',blockSize:10,textString:'...',clearance:10,ordering:'default',animate:false,name:null,active:1,x:0,y:0},options={},saveOptions=function(){for(var option in defaults){if(!!initOptions[option]){options[option]=initOptions[option];}else{options[option]=defaults[option];}}},isActive=function(){return options.active;},setActiveVal=function(val){options.active=val;if(!!options.animate){currentBlock=0;}},updateString=function(str){debug('updateString');options.textString=str;setActiveVal(1);startLetters();},startLetters=function(){lineCount=1;currentBlock=0;blocks=[];blockCount=0;if(options.x<0){currentX=visibleWidth-(options.blockSize*characterBlockHeight*(options.textString.length-1))+options.x;}else{currentX=options.x+0;}if(options.y<0){currentY=visibleHeight-options.clearance-(options.blockSize*characterBlockHeight)+options.y;}else{currentY=options.y+0;}fixTextLength();calculateBlockPositions();if(!options.animate){currentBlock=blocks.length;}if(!!textBlocks['options.name']){textBlocks['options.name'].setActiveVal(1);}debug('adding '+options.name+' to queue');},fixTextLength=function(){textString=options.textString.toLowerCase();var lineLength=Math.floor((canvas.width-options.clearance)/((characterBlockWidth*options.blockSize)+options.clearance));textStringArray=textString.split(' ');for(var counter=textStringArray.length-1;counter>=0;counter--){if(textStringArray[counter].length>lineLength){var originalWord=word=textStringArray[counter];var wordArray=[];while(word.length>lineLength){wordArray.push(word.substr(0,lineLength-1));word=word.substr(lineLength-1);}wordArray.push(word);textString=textString.replace(originalWord,wordArray.join('- '));}};},calculateBlockPositions=function(){for(var character=0,textStringLength=textString.length;character<textString.length;character++){if(!!characters[textString[character]]){if(character>0){currentX+=(options.blockSize*characterBlockWidth)+options.clearance;}var nextSpacePosition=textString.indexOf(' ',character);if(nextSpacePosition==-1){nextSpacePosition=textStringLength;}var newLineRequired=false;if(currentX+(options.blockSize*(characterBlockWidth*(nextSpacePosition-character)))+(options.clearance*(nextSpacePosition-character))>canvas.width-options.clearance){newLineRequired=true;}if(newLineRequired&&textString[character]!=' '){currentX=options.clearance;currentY=(lineCount*(characterBlockHeight*options.blockSize))+(options.clearance*++lineCount);}var blockArray=characters[textString[character]];for(var block=0,blockArrayLength=blockArray.length;block<blockArrayLength;block++){var x=currentX;var y=currentY;x+=(options.blockSize*(block%characterBlockWidth));if(block>=characterBlockWidth){y+=(options.blockSize*(Math.floor(block/characterBlockWidth)));}if(blockArray[block]==1){blocks.push({x:x,y:y,opacity:0});}}}}switch(options.ordering){case 'vertical':function vertical(a,b){return a.y-b.y;}blocks.sort(vertical);break;case 'horizontal':function horizontal(a,b){return a.x-b.x;}blocks.sort(horizontal);break;case 'reverse':blocks.reverse();break;case 'random':function randOrd(){return(Math.round(Math.random())-0.5);}blocks.sort(randOrd);break;}blockCount=blocks.length;},drawBlocks=function(){var drawColour=options.blockColour;var animateLimit=(!!options.animate)?currentBlock-10:0;for(var counter=animateLimit;counter<currentBlock;counter++){if(!!blocks[counter]){if(blocks[counter].opacity<1){blocks[counter].opacity+=0.1;}drawContext.fillStyle='rgba('+HexToRGB(drawColour)+', '+blocks[counter].opacity+')';drawRectangle(blocks[counter].x,blocks[counter].y,options.blockSize,options.blockSize);}};currentBlock++;if(currentBlock==blockCount+10){debug('finished drawing '+options.textString);}},HexToRGB=function(h){return HexToR(h)+','+HexToG(h)+','+HexToB(h);},HexToR=function(h){return parseInt((cutHex(h)).substring(0,2),16);},HexToG=function(h){return parseInt((cutHex(h)).substring(2,4),16);},HexToB=function(h){return parseInt((cutHex(h)).substring(4,6),16);},cutHex=function(h){return(h.charAt(0)=='#')?h.substring(1,7):h;},__init=function(){saveOptions();debug('drawing '+options.textString);startLetters();}();return{init:init,isActive:isActive,setActiveVal:setActiveVal,drawBlocks:drawBlocks,updateString:updateString};};init();}();})();">Browser Breakout</a>